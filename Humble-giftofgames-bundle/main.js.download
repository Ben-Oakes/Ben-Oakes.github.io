function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define("common/productTiles/constants",["require"],function(e){return{TILE_SIZES:{FULL:"full",HERO:"hero",THREE_FOURTHS:"three-fourths",HALF:"half",QUARTER:"quarter",ONE_THIRD:"one-third"},STAMPS:{MIXED:"mixed",BOOKS:"books",GAMES:"games",COMICS:"comics",MONTHLY_STAMP:"monthly_stamp",AUDIOBOOK:"audiobook",MOBILE:"mobile",SOFTWARE:"software"},HERO_GRID:{SQUARE_LENGTH:150,GAME_WIDTH:308,GAME_HEIGHT:177,COVER_WIDTH:150,COVER_HEIGHT:218},PRODUCT_TYPES:{MONTHLY:"monthly",COUPON:"coupon",STORE:"store",BUNDLE:"bundle",CUSTOM:"custom"},CUSTOM_TILE_TYPES:{HTML:"html",BUNDLE_MONTHLY:"bundle/monthly"}}}),define("util/templating",["module","underscore","util/main"],function(e,t,n){"use strict";function i(e,n){return e.replace(/<%\s*include\(\s*['"]([^'"]+)['"](?:\s*,\s*({[^}]+}))?\s*\)\s*%>/g,function(e,o,s){if(t.contains(n,o))throw new Error("Cycle detected: "+o);var a=document.getElementById(o),r=a?a.innerHTML:"";s&&(r="<% with("+s+") { %>"+r+"<% } %>");var l=n.slice(0);return l.push(o),i(r.trim(),l)})}function o(e,t){t=t||{};var n=document.getElementById(e);if(!n)throw new Error('no template with id "'+e+'"');var i=n?n.innerHTML:"";return s(i,t)}function s(e,n){n=t.extend({},n);var o=i(e.trim(),[]),e=t.template(o);t.extend(n,l);try{return e(n)}catch(e){throw Raven.captureException(e),e}}var a=function(e){return t.template(i(jQuery(e).html().trim(),[]))},r=e.config().STATIC_URL,l={STATIC_URL:r,moneyfmt:n.moneyfmt};return{renderTemplateId:o,renderTemplate:s,getTemplate:a}}),define("common/DOMLessView",["require","marionette","util/templating"],function(e){"use strict";var t=e("marionette"),n=e("util/templating"),i=t.ItemView.extend({_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new t.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var i=this.mixinTemplateHelpers(this.serializeData()),o=n.renderTemplate(e,i);return this.attachElContent(o),this}}});return i}),define("lib/hbTemplate!navbar/templates/BundleDropdownView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="js-dropdown-underlay dropdown-underlay"></div>\n<div class="js-dropdown-button dropdown-button">\n  <div class="js-button-title button-title\n<% if (isSelected) { %>\n    is-selected\n<% } %>\n    ">\n    <%- tileCount %> Bundles <i class="hb hb-caret-down"></i>\n  </div>\n  <div class="js-bundle-dropdown-wrapper bundle-dropdown-wrapper">\n    <div class="bundle-dropdown-content-wrapper">\n      <div class="bundle-dropdown-content js-bundle-dropdown-content"></div>\n    </div>\n  </div>\n</div>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("common/productTiles/models",["require","backbone","lib/big","util/main","jquery","common/productTiles/constants"],function(e){"use strict";var t=e("backbone"),n=e("lib/big"),i=e("util/main"),o=e("jquery"),s=e("common/productTiles/constants"),a=t.Model.extend({idAttribute:"machine_name",defaults:{is_custom:!1,end_date:void 0,tile_image:"",tile_logo:"",tile_stamp:"",tile_name:"",type:"",size:"quarter"},getEndDate:function(){return this.get("end_date")}}),r=a.extend({defaults:o.extend(!0,{},a.prototype.defaults,{bundles_sold:0,msrp:0,type:"bundle",image_grid_urls:[],image_grid_item_width:0,image_grid_item_height:0,marketing_blurb:"",detailed_marketing_blurb:""})}),l=a.extend({defaults:o.extend(!0,{},a.prototype.defaults,{detailed_marketing_blurb:"",marketing_blurb:"",type:"monthly"})}),c=a.extend({defaults:o.extend(!0,{},a.prototype.defaults,{current_price:0,full_price:0,operating_systems:[],platforms:[],type:"store"}),getPriceAsBig:function(e){return e?new n(e.amount):null},getFullPriceAsBig:function(){return this.getPriceAsBig(this.get("full_price"))},getCurrentPriceAsBig:function(){return this.getPriceAsBig(this.get("current_price"))},getCurrency:function(){var e=this.get("full_price");return e?e.currency:null},getDisplayPrice:function(e){return i.moneyfmt(e.amount,e.currency)},getDisplayFullPrice:function(){return this.getDisplayPrice(this.get("full_price"))},getDisplayCurrentPrice:function(){return this.getDisplayPrice(this.get("current_price"))},getHumanDiscount:function(){return this.hasDiscount()?new n(100).times(this.getPriceDifferenceAsBig().div(this.getFullPriceAsBig())).toFixed(0):0},getPriceDifferenceAsBig:function(){return this.hasPrice()?this.getFullPriceAsBig().minus(this.getCurrentPriceAsBig()):null},hasPrice:function(){return this.get("full_price")&&this.get("current_price")},hasDiscount:function(){this.getCurrentPriceAsBig();return this.hasPrice()&&!this.getCurrentPriceAsBig().eq(this.getFullPriceAsBig())}}),u=r.extend({defaults:o.extend(!0,{},r.prototype.defaults,{is_custom:!0})}),d=t.Collection.extend({model:function(e,t){var n=e.type;switch(n){case s.PRODUCT_TYPES.STORE:return new c(e,t);case s.PRODUCT_TYPES.BUNDLE:return new r(e,t);case s.PRODUCT_TYPES.MONTHLY:return new l(e,t);default:return new u(e,t)}}});return{BundleTile:r,MonthlyTile:l,StoreTile:c,TileCollection:d}}),define("pubnub",["jquery","lib/pubnub"],function(e,t){"use strict";function n(e){this._log=[];var t=this;e.forEach(function(e){t[e]=function(){t._log.push([e,Array.prototype.slice.call(arguments)])}}),this._playback=function(e){t._log.forEach(function(t){methodname=t[0],args=t[1],method=e[methodname],method.apply(e,args)})}}function i(e,t){var n=m[e]||[];n.push(t),m[e]=n}function o(e){delete m[e]}function s(e,t,n){var i=!0,o=!1,s=void 0;try{for(var a,r=m[n][Symbol.iterator]();!(i=(a=r.next()).done);i=!0){var l=a.value;l(e)}}catch(e){o=!0,s=e}finally{try{!i&&r.return&&r.return()}finally{if(o)throw s}}}function a(n){u||(c=n.preamble,u=t.init(n.credentials)),d||(d={},e.extend(d,u),d.subscribe=function(e){return i(e.channel,e.callback),e.callback=s,u.subscribe(e)},d.unsubscribe=function(e){return o(e.channel),u.unsubscribe(e)},d.ready(),h._playback(d))}function r(e){var t=_.extend({},e,{channel:c+e.channel});return d.subscribe(t)}function l(e){var t=_.extend({},e,{channel:c+e.channel});return d.unsubscribe(t)}var c,u,d,h=new n(["subscribe","unsubscribe","history"]),m={};return{initialize:a,subscribe:r,unsubscribe:l}}),define("constants/platformAndDelivery",["require"],function(e){return{web_delivery_methods:{asmjs:"asmjs",unitywasm:"unitywasm"},delivery_method_definition_dict:{origin:{human_name:"Origin",preamble:"Redeem for",icon:"hb-origin"},asmjs:{preamble:"Play in",icon:"hb-bundle"},blizzard:{importance:5,human_name:"Blizzard Battle.net",preamble:"Redeem for",icon:"hb-blizzard"},xboxone:{human_name:"Xbox One",preamble:"Play on",icon:"hb-xboxone"},wiiu:{human_name:"WiiU",preamble:"Redeem on",icon:"hb-WiiU"},download:{importance:2,human_name:"DRM-free download",preamble:"Download for",icon:"hb-drmfree"},ps3:{human_name:"PS3",preamble:"Play on",icon:"hb-psthree"},ps4:{human_name:"PS4",preamble:"Play on",icon:"hb-psfour"},"video-download":{human_name:"Movie",preamble:"Download",icon:"hb-movie"},web:{preamble:"Play in",icon:"hb-globe"},gog:{importance:3,human_name:"GOG",preamble:"Redeem for",icon:"hb-gog"},download_drm:{human_name:"DRM download",preamble:"Redeem for",icon:"hb-key"},"audio-download":{human_name:"Audio download",preamble:"Download",icon:"hb-audio"},"3DS":{human_name:"3DS",preamble:"Redeem on",icon:"hb-threeds"},iOS:{human_name:"iOS",preamble:"Redeem for",icon:"hb-osx"},"other-key":{human_name:"Key",preamble:"Redeem for",icon:"hb-key"},rifftrax:{preamble:"Available via",icon:"hb-rifftrax"},android:{human_name:"Android",preamble:"Download for",icon:"hb-android"},psvita:{human_name:"PSVita",preamble:"Play on",icon:"hb-psvita"},vhx:{human_name:"VHX",preamble:"Download/stream on",icon:"hb-movie"},"physical-copy":{human_name:"Physical Copy",icon:"hb-library"},uplay:{importance:4,human_name:"Uplay",preamble:"Redeem for",icon:"hb-uplay"},steam:{importance:1,human_name:"Steam",preamble:"Redeem for",icon:"hb-steam"}},platform_definition_dict:{firefox:{human_name:"Firefox",icon:"hb-firefox"},flac:{human_name:"FLAC",icon:"hb-file"},xboxone:{human_name:"Xbox One",icon:"hb-xboxone"},mp3:{human_name:"MP3",icon:"hb-file-mp3"},wiiu:{human_name:"Nintendo Wii U",icon:"hb-WiiU"},linux:{importance:3,human_name:"Linux",icon:"hb-linux"},ps3:{human_name:"Playstation 3",icon:"hb-psthree"},ps4:{human_name:"Playstation 4",icon:"hb-psfour"},chrome:{human_name:"Chrome",icon:"hb-chrome"},wav:{human_name:"WAV",icon:"hb-file-audio-o"},android:{human_name:"Android",icon:"hb-android"},"3DS":{human_name:"Nintendo 3DS",icon:"hb-threeds"},iOS:{human_name:"iOS",icon:"hb-osx"},mac:{importance:2,human_name:"Mac",icon:"hb-osx"},rifftrax:{human_name:"Rifftrax",icon:"hb-rifftrax"},hd:{human_name:"HD",icon:"hb-movie"},psvita:{human_name:"Playstation Vita",icon:"hb-psvita"},vive:{human_name:"HTC Vive",icon:"hb-vive"},windows:{importance:1,human_name:"Windows",icon:"hb-windows"},"physical-copy":{human_name:"Physical Copy",icon:"hb-library"},"oculus-rift":{human_name:"Oculus Rift",icon:"hb-oculus"},sd:{human_name:"SD",icon:"hb-movie"},browser:{human_name:"modern browsers like Chrome or Firefox",icon:"hb-singleplatform"}}}}),define("constants/csrfConstants",["require"],function(e){return{CSRF_COOKIE_KEY:"csrf_cookie",CSRF_COOKIE_VERSION:1,CSRF_FORM_KEY:"_le_csrf_token",CSRF_HEADER_KEY:"CSRF-Prevention-Token"}}),define("util/csrfUtils",["constants/csrfConstants"],function(e){function t(){var t=document.cookie,n=t.lastIndexOf(e.CSRF_COOKIE_KEY);n=n+e.CSRF_COOKIE_KEY.length+1;var t=t.slice(n),i="";if(t.length){var o=t.indexOf(";");i=o>-1?t.slice(0,o):t}return i}return{getCsrf:t,formKey:e.CSRF_FORM_KEY,headerKey:e.CSRF_HEADER_KEY}}),define("lib/hbTemplate!account/templates/AccountStart.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="full-logo">\n  <img src="xSTATIC_URLx/static/hashed/2601f8ca3aefe063e1e1c0fbdb6ef0ecc2c7f9f2.svg" alt="Humble Bundle">\n</div>\n<button class="button large account-cta green js-account-login">Log in</button>\n<br>\n<br>\n<button class="button large account-cta green js-account-signup">Sign up</button>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/AccountStartView",["require","common/DOMLessView","hbtemplate!./templates/AccountStart.html"],function(e){"use strict";var t=e("common/DOMLessView"),n=e("hbtemplate!./templates/AccountStart.html"),i=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"onRender",value:function(){$(".account-modal-outer").addClass("account-reveal-background-image")}},{key:"onBeforeDestroy",value:function(){$(".account-modal-outer").removeClass("account-reveal-background-image")}}]),t}(t);return i.prototype.className="account-view",i.prototype.template=n,i}),define("constants/skipCodes",["require"],function(e){return{SKIP_CODE_SECONDS:300}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/collections/Validators",["require","backbone"],function(e){"use strict";var t=e("backbone"),n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"validate",value:function(e){var t=this.get("validation")(e.get(this.id));return this.set("valid",t),t&&this.set("show_error",!1),t}}]),t}(t.Model);n.prototype.defaults={validation:function(){return!0},valid:!0,show_error:!1};var i=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"validate",value:function(e,t){t=t||[];var n=!0;return this.each(function(i){var o=i.validate(e);!o&&t.indexOf(i.id)>-1&&i.set("show_error",!0),o||(n=!1)}),n}}]),t}(t.Collection);return i.prototype.model=n,i}),define("lib/hbTemplate!account/templates/SubmitButton.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<button type="submit" name="button"\n       class="button large account-cta<% if (valid && !loading) { %> green<% } %>"\n       <% if (!valid || loading) { %> disabled<% } %>>\n       <% if (!loading) { %>\n         <%= cta %>\n      <% } else { %>\n        \n        <div class="sk-circle">\n          <div class="sk-circle1 sk-child"></div>\n          <div class="sk-circle2 sk-child"></div>\n          <div class="sk-circle3 sk-child"></div>\n          <div class="sk-circle4 sk-child"></div>\n          <div class="sk-circle5 sk-child"></div>\n          <div class="sk-circle6 sk-child"></div>\n          <div class="sk-circle7 sk-child"></div>\n          <div class="sk-circle8 sk-child"></div>\n          <div class="sk-circle9 sk-child"></div>\n          <div class="sk-circle10 sk-child"></div>\n          <div class="sk-circle11 sk-child"></div>\n          <div class="sk-circle12 sk-child"></div>\n        </div>\n      <% } %></button>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!account/templates/ErrorBox.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="js-close-message close-message">\n  <i class="hb hb-times"></i>\n</div>\n<div class="error-message"><%= message %></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/BaseAccountView",["require","lib/jquery/full","lib/lodash","backbone","constants/skipCodes","common/DOMLessView","util/csrfUtils","account/collections/Validators","hbtemplate!./templates/SubmitButton.html","hbtemplate!./templates/ErrorBox.html"],function(e){"use strict";var t=e("lib/jquery/full"),n=e("lib/lodash"),i=e("backbone"),o=e("constants/skipCodes"),s=e("common/DOMLessView"),a=e("util/csrfUtils"),r=e("account/collections/Validators"),l=e("hbtemplate!./templates/SubmitButton.html"),c=e("hbtemplate!./templates/ErrorBox.html"),u=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(){this.listenTo(this.model,"change:valid",this.render.bind(this)),this.listenTo(this.model,"change:loading",this.render.bind(this))}}]),t}(s);u.prototype.template=l;var d=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){var t=e.errorMessage;this.errorMessage=t,this.listenTo(this.model,"change:show_error",this.toggle.bind(this))}},{key:"toggle",value:function(){this.model.get("show_error")?this.$el.show():this.$el.hide()}},{key:"showErrorMessage",value:function(){this.errorMessage.set({message:this.model.get("submit_message")||this.model.get("message"),show_message:!0}),this.model.unset("submit_message")}}]),t}(i.View);d.prototype.events={click:"showErrorMessage"};var h=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(){this.listenTo(this.model,"change:show_message",this.render.bind(this)),this.listenTo(this.model,"change:message",this.render.bind(this))}},{key:"closeErrorMessage",value:function(){this.model.set("show_message",!1)}},{key:"slideView",value:function(){var e=this;this.model.get("show_message")?(this.$el.addClass("slide-up"),this.model.set("timeout",setTimeout(function(){e.model.set("show_message",!1),e.model.unset("timeout")},5e3))):(this.model.get("timeout")&&(clearTimeout(this.model.get("timeout")),this.model.unset("timeout")),this.$el.removeClass("slide-up"))}},{key:"onRender",value:function(){this.slideView()}}]),t}(s);h.prototype.events={"click .js-close-message":"closeErrorMessage"},h.prototype.template=c;var m=function(e){function s(){return _classCallCheck(this,s),_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return _inherits(s,e),_createClass(s,[{key:"initialize",value:function(e){var t=e.attributes;this.createModel(t||{}),this.createValidators(this.validations),this.listenTo(this.model,"change:previous_view",this.render.bind(this))}},{key:"addValidator",value:function(e){this.removeValidator(e.id);var t=new d({model:e,errorMessage:this.errorMessage,el:this.$("#error-"+e.id)});this.inputErrors[e.id]=t}},{key:"createModel",value:function(e){var t={};if(e.gotoHref&&"#"!=e.gotoHref)t={goto:e.gotoHref,qs:e.queryString};else{t.goto=window.location.pathname;var o=window.location.search;o&&(t.qs=o.substr(1))}this.model=new i.Model(n.extend({valid:!1,loading:!1,previous_view:!1,cta:this.cta},t,this.getDefaultFields(e)))}},{key:"createValidators",value:function(e){this.validators=new r(e),this.errorMessage=new i.Model({message:"",show_message:!1}),this.inputErrors={}}},{key:"executeCaptcha",value:function(e,t){if(this.model.get("captcha-skip-code"))return void e();if(this.captcha)this.captcha.reset();else{var n=this.cid+"-captcha";this.$(t).html('<div id="'+n+'"></div>'),this.captcha=CreateCaptcha(n,e,{size:"invisible"})}this.captcha.execute()}},{key:"getCaptchaData",value:function(e){var t={};return this.model.get("captcha-skip-code")?(n.extend(t,{"captcha-skip-code":this.model.get("captcha-skip-code")}),this.model.unset("captcha-skip-code")):this.captcha&&n.extend(t,this.captcha.getResponseParameters(e,!0)),t}},{key:"getDefaultFields",value:function(){return{}}},{key:"getSubmitData",value:function(){return{}}},{key:"onBeforeDestroy",value:function(){n.values(this.inputErrors).forEach(function(e){return e.remove()})}},{key:"onError",value:function(e){var t=this,i=e.responseJSON,o="Submit failed. Please try again.";i=i||{},i.skip_code&&this.setModelSkipCode(i.skip_code),i.errors&&n.forOwn(i.errors,function(e,n){var i=null;e.length&&(i=e[0]),t.validators.get(n)?t.validators.get(n).set({submit_message:i,show_error:!0}):o=i}),this.model.set("loading",!1),this.errorMessage.set({message:o,show_message:!0})}},{key:"onRender",value:function(){var e=this,t=new u({el:this.$(".account-submit"),model:this.model});t.render();var n=new h({el:this.$(".error-box"),model:this.errorMessage});n.render(),this.validators.each(function(t){return e.addValidator(t)})}},{key:"onSubmit",value:function(e){if(e&&e.preventDefault(),this.validate())return this.errorMessage.set({message:"",show_message:!1}),this.model.set("loading",!0),this.captchaRequired?void this.executeCaptcha(this.submitRequest.bind(this),".account-captcha"):void this.submitRequest()}},{key:"onSuccess",value:function(e){this.model.set("loading",!1)}},{key:"removeValidator",value:function(e){this.inputErrors[e]&&(this.inputErrors[e].remove(),delete this.inputErrors[e])}},{key:"setModelSkipCode",value:function(e){var t=this;e=e||this.model.get("extra_skip_codes"),e&&e.length&&(this.model.set("captcha-skip-code",e.pop()),this.model.set("extra_skip_codes",e),setTimeout(function(){t.model.unset("captcha-skip-code"),t.model.unset("extra_skip_codes")},1e3*(o.SKIP_CODE_SECONDS-60)))}},{key:"submitRequest",value:function(e){var i=this.getSubmitData();n.extend(i,this.getCaptchaData(e)),t.ajax({data:i,type:"POST",url:this.url,dataType:"json",headers:_defineProperty({},a.headerKey,a.getCsrf()),error:this.onError.bind(this),success:this.onSuccess.bind(this)})}},{key:"updateModel",value:function(e){var n=t(e.target);this.model.set(n.attr("name"),n.val()),this.validate()}},{key:"updateCheckbox",value:function(e){var n=t(e.target);this.model.set(n.attr("name"),n.is(":checked")),this.validate()}},{key:"updateMessaging",value:function(e){var n=t(e.target);this.validate([n.attr("name")])}},{key:"validate",value:function(e){var t=this.validators.validate(this.model,e);return this.model.set("valid",t),t}}]),s}(s);return m.prototype.className="account-view",m.prototype.events={input:"updateModel","change input:checkbox":"updateCheckbox","blur input":"updateMessaging",submit:"onSubmit"},m.prototype.tagName="form",m.prototype.template=!1,m.prototype.validations=[],m}),define("lib/hbTemplate!account/templates/AccountSignup.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<% if (previous_view) { %>\n<div class="account-back-arrow js-previous">\n  <i class="hb hb-chevron-left"></i>\n</div>\n<% } %>\n<div class="account-captcha"></div>\n<div class="checkbox">\n  <input type="checkbox" name="subscribe" value="true" <% if (subscribe) { %>checked<% } %>>\n  <label for="">Notify me about Humble Bundle promotions. (You may unsubscribe from the newsletter at any time)</label>\n</div>\n<div class="account-information account-fine-print">\n  I <% if (countryCode == \'US\') { %>am 13 years of age or older and <% } %>understand and agree to this website\'s <a href="/terms">Terms</a> and <a href="/privacy">Privacy Policy</a>.\n</div>\n<div class="account-input-group">\n  <div class="suggestion-popup"></div>\n  <label for="" class="account-label">Email</label>\n  <input type="email" name="email" value="<%= email %>" class="account-input">\n  <div id="error-email" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-input-group">\n  <label for="" class="account-label">Password</label>\n  <input type="password" name="password" value="<%= password %>" class="account-input">\n  <div id="error-password" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-information account-support">\n  <a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a>\n</div>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!account/templates/InputSuggestion.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'Did you mean <span class="js-email-suggestion email-suggestion"><%= address %>@<strong><%= domain %></strong></span>?\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/SignUpView",["require","lib/jquery/full","lib/lodash","backbone","util/main","lib/email-validation","common/DOMLessView","account/BaseAccountView","hbtemplate!./templates/AccountSignup.html","hbtemplate!./templates/InputSuggestion.html"],function(e){"use strict";var t=e("lib/jquery/full"),n=e("lib/lodash"),i=e("backbone"),o=e("util/main"),s=e("lib/email-validation"),a=e("common/DOMLessView"),r=e("account/BaseAccountView"),l=e("hbtemplate!./templates/AccountSignup.html"),c=e("hbtemplate!./templates/InputSuggestion.html"),u=function(e){function t(){return _classCallCheck(this,t),
_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){var t=e.$input,n=e.formModel;this.$input=t,this.formModel=n,this.listenTo(this.formModel,"change:email",this.fadeOut.bind(this))}},{key:"fadeOut",value:function(){var e=this;this.$el.parent().fadeOut(function(){return e.remove()})}},{key:"setSuggestion",value:function(){this.$input.val(this.model.get("full")),this.formModel.set("email",this.model.get("full"))}}]),t}(a);u.prototype.events={"click .js-email-suggestion":"setSuggestion"},u.prototype.template=c;var d=function(e){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,e),_createClass(n,[{key:"getDefaultFields",value:function(e){var t=window.models&&window.models.request.country_code,n=!("CA"===t||e.is_eu_country);return{countryCode:t,subscribe:n,email:null,password:null}}},{key:"recommendDomain",value:function(e){var n=this,o=t(e.target);o.mailcheck({domains:s.MAILCHECK_DOMAINS,suggested:function(e,t){var o=new i.Model(t),s=new u({model:o,$input:e,formModel:n.model}).render();n.$(".suggestion-popup").html(s.$el),n.$(".suggestion-popup").fadeIn()}})}},{key:"getSubmitData",value:function(){var e=this.model.attributes,t=e.subscribe,n=e.email,i=e.password,o=e.goto,s=e.qs;return{subscribe:t,email:n,password:i,goto:o,qs:s}}},{key:"onSuccess",value:function(e){e=e||{},o.redirectInDomain(e.goto||"/")}}]),n}(r);return d.prototype.captchaRequired=!0,d.prototype.cta="Sign up",d.prototype.events=n.extend({"change input[type=email]":"recommendDomain"},r.prototype.events),d.prototype.template=l,d.prototype.url="/signup",d.prototype.validations=[{id:"email",validation:s.isValidEmail,message:"Invalid Email"},{id:"password",validation:function(e){return e&&e.length>3},message:"Password must be at least 4 characters"}],d});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/SendSmsView",["require","lib/lodash","util/csrfUtils","account/BaseAccountView"],function(e){"use strict";var t=e("lib/lodash"),n=e("util/csrfUtils"),i=e("account/BaseAccountView"),o=function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return _inherits(i,e),_createClass(i,[{key:"initialize",value:function(e){var t=e.errorMessage;this.errorMessage=t}},{key:"onSendSmsClick",value:function(e){e.preventDefault(),this.model.get("loading")||(this.$text=$(e.target),this.$text.html("Sending...."),this.model.set("loading",!0),this.executeCaptcha(this.sendSms.bind(this),".sms-captcha"))}},{key:"sendSms",value:function(e){var i=this,o=arguments,s=_defineProperty({},n.headerKey,n.getCsrf()),a=t.cloneDeep(this.model.attributes);t.extend(a,this.getCaptchaData(e)),$.ajax({headers:s,data:a,url:"/user/authy/send-sms",type:"POST",dataType:"json"}).success(function(e){var t="SMS sent! Please enter your code.";i.errorMessage.set({message:t,show_message:!0}),i.setModelSkipCode(e.skip_code)}).error(function(){i.onError(o)}).always(function(){i.$text.html("Resend SMS"),i.model.set("loading",!1)})}}]),i}(i);return o.prototype.events={"click .js-send-sms":"onSendSmsClick"},o}),define("lib/hbTemplate!account/templates/TwoFactor.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-captcha"></div>\n<div class="account-input-group">\n  <div class="suggestion-popup"></div>\n  <label for="" class="account-label"><%= twofactor_type === \'authy\' ? \'Authy Code\' : \'Google Authenticator\' %></label>\n  <input type="text" name="code" value="<%= code %>" class="account-input">\n  <div id="error-code" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<% if (twofactor_type === \'authy\') { %>\n  <div class="account-information account-support account-support-split sms-view">\n    <span class="js-send-sms">Send SMS</span>\n    <div class="sms-captcha"></div>\n    <a href="https://support.humblebundle.com/hc/en-us/articles/202421374" target="_blank">Help</a>\n  </div>\n<% } else { %>\n  <div class="account-information account-support">\n    <a href="https://support.humblebundle.com/hc/en-us/articles/202421374" target="_blank">Help</a>\n  </div>\n<% } %>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/TwoFactorView",["require","util/main","account/BaseAccountView","account/SendSmsView","hbtemplate!./templates/TwoFactor.html"],function(e){"use strict";var t=e("util/main"),n=e("account/BaseAccountView"),i=e("account/SendSmsView"),o=e("hbtemplate!./templates/TwoFactor.html"),s=function(e){function o(){return _classCallCheck(this,o),_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(e){var t=e.attributes;this.model=t.model,this.model.set({valid:!1,loading:!1,cta:this.cta}),this.createValidators(this.validations)}},{key:"getSubmitData",value:function(){var e=this.model.attributes,t=e.username,n=e.password,i=e.code,o=e.qs,s=e.goto;return{username:t,password:n,code:i,qs:o,goto:s}}},{key:"onRender",value:function(){"authy"===this.model.get("twofactor_type")&&new i({model:this.model,el:this.$(".sms-view"),errorMessage:this.errorMessage}),n.prototype.onRender.apply(this)}},{key:"onSuccess",value:function(e){e=e||{},t.redirectInDomain(e.goto||"/")}}]),o}(n);return s.prototype.captchaRequired=!0,s.prototype.cta="Authenticate",s.prototype.template=o,s.prototype.url="/processlogin",s.prototype.validations=[{id:"code",validation:function(e){return!!e},message:"Code Required"}],s}),define("lib/hbTemplate!account/templates/Login.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<% if (previous_view) { %>\n<div class="account-back-arrow js-previous">\n  <i class="hb hb-chevron-left"></i>\n</div>\n<% } %>\n<% if (free_copy) { %>\n<div class="account-information">\n  You must be logged into a Humble Bundle account to redeem your free copy of <%= free_copy %>\n</div>\n<% } %>\n<div class="account-captcha"></div>\n<div class="account-input-group">\n  <div class="suggestion-popup"></div>\n  <label for="" class="account-label">Email</label>\n  <input type="email" name="username" value="<%= username %>" class="account-input">\n  <div id="error-username" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-input-group">\n  <label for="" class="account-label">Password</label>\n  <input type="password" name="password" value="<%= password %>" class="account-input">\n  <div id="error-password" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-information account-support">\n  <span class="js-password-reset">Forgot Password?</span>\n</div>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/LoginView",["require","backbone","util/main","account/BaseAccountView","account/TwoFactorView","hbtemplate!./templates/Login.html"],function(e){"use strict";var t=e("backbone"),n=e("util/main"),i=e("account/BaseAccountView"),o=e("account/TwoFactorView"),s=e("hbtemplate!./templates/Login.html"),a=function(e){function s(){return _classCallCheck(this,s),_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return _inherits(s,e),_createClass(s,[{key:"getDefaultFields",value:function(e){var t=e.free_copy;return{username:null,password:null,free_copy:t}}},{key:"getSubmitData",value:function(){var e=this.model.attributes,t=e.username,n=e.password,i=e.goto,o=e.qs;return{username:t,password:n,goto:i,qs:o}}},{key:"onError",value:function(e){var n=e.responseJSON;if(n&&n.two_factor_required){this.setModelSkipCode(n.skip_code);var s={username:this.model.get("username"),password:this.model.get("password"),goto:this.model.get("goto"),qs:this.model.get("qs"),code:null,active_view:"twofactor",twofactor_type:n.twofactor_type,extra_skip_codes:this.model.get("extra_skip_codes"),"captcha-skip-code":this.model.get("captcha-skip-code"),use_modal_model:!0};if(this.modal)this.modal.set(s);else if(this.$parentEl){var a=new o({attributes:{model:new t.Model(s)}});this.$parentEl.html(a.render().el),this.remove()}}else i.prototype.onError.apply(this,arguments),n&&n.errors&&n.errors.username&&this.errorMessage.set({message:n.errors.username[0],show_message:!0})}},{key:"onRender",value:function(){this.$el.attr("novalidate",!0),i.prototype.onRender.apply(this)}},{key:"onSuccess",value:function(e){e=e||{},n.redirectInDomain(e.goto||"/")}}]),s}(i);return a.prototype.captchaRequired=!0,a.prototype.cta="Log in",a.prototype.template=s,a.prototype.url="/processlogin",a.prototype.validations=[{id:"username",validation:function(e){return!!e},message:"Email Required"},{id:"password",validation:function(e){return!!e},message:"Password Required"}],a}),define("lib/hbTemplate!account/templates/HumbleGuard.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-captcha"></div>\n<div class="account-information">\n  <h1>Verify account</h1>\n  It looks like you are accessing your Humble Bundle account from an unfamiliar browser.\n  For your protection, we need to verify that this computer is yours.\n  We\'ve sent a code to the email address attached to this account.\n</div>\n<div class="account-input-group">\n  <label for="" class="account-label">Code</label>\n  <input type="text" name="code" value="<%= code %>" class="account-input">\n  <div id="error-code" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-information account-support account-support-split js-email-view">\n  <div class="js-resend-code"><span>Resend Code</span></div>\n  <div class="email-captcha"></div>\n  <div><a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a></div>\n</div>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/HumbleGuardView",["require","lib/jquery/full","lib/lodash","util/csrfUtils","util/main","account/BaseAccountView","hbtemplate!./templates/HumbleGuard.html"],function(e){"use strict";var t=e("lib/jquery/full"),n=(e("lib/lodash"),e("util/csrfUtils")),i=e("util/main"),o=e("account/BaseAccountView"),s=e("hbtemplate!./templates/HumbleGuard.html"),a=function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return _inherits(i,e),_createClass(i,[{key:"initialize",value:function(e){var t=e.errorMessage;this.errorMessage=t}},{key:"onSendEmailClick",value:function(e){e.preventDefault(),this.model.get("loading")||(this.$text=t(e.target),this.$text.html("Resending...."),this.model.set("loading",!0),this.executeCaptcha(this.sendEmail.bind(this),".email-captcha"))}},{key:"sendEmail",value:function(e){var i=this,o=_defineProperty({},n.headerKey,n.getCsrf());t.ajax({type:"POST",url:"/user/humbleguard?resend=1",headers:o}).success(function(e){var t="Code Resent";i.errorMessage.set({message:t,show_message:!0}),i.setModelSkipCode(e.skip_code)}).error(function(){var e="Slow Down! Please wait 24 hours before trying again.";i.errorMessage.set({message:e,show_message:!0})}).always(function(){i.$text.html("Resend Code"),i.model.set("loading",!1)})}}]),i}(o);a.prototype.events={"click .js-resend-code":"onSendEmailClick"};var r=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getDefaultFields",value:function(e){return{code:null}}},{key:"getSubmitData",value:function(){var e=this.model.attributes,t=e.code,n=e.goto,i=e.qs;return{code:t,goto:n,qs:i}}},{key:"onRender",value:function(){new a({model:this.model,el:this.$(".js-email-view"),errorMessage:this.errorMessage}),o.prototype.onRender.apply(this)}},{key:"onSuccess",value:function(e){this.successCallback?(this.successCallback(),this.modal.set("close",!0)):i.redirectInDomain(e.goto||"/")}},{key:"onBeforeDestroy",value:function(){this.destroyCallback&&this.destroyCallback(),o.prototype.onBeforeDestroy.call(this)}}]),t}(o);return r.prototype.captchaRequired=!0,r.prototype.cta="Verify",r.prototype.url="/user/humbleguard",r.prototype.validations=[{id:"code",validation:function(e){return!!e},message:"Please enter your code"}],r.prototype.template=s,r}),define("lib/hbTemplate!account/templates/PasswordConfirmation.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-captcha"></div>\n<div class="account-information">\n  <h1>Confirm Password</h1>\n  For security reasons, please enter your current password.\n</div>\n<div class="account-input-group">\n  <label for="" class="account-label">Password</label>\n  <input type="password" name="password" value="<%= password %>" class="account-input">\n  <div id="error-password" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<% if (two_factor_required) { %>\n  <div class="account-input-group">\n    <div class="suggestion-popup"></div>\n    <label for="" class="account-label"><%= twofactor_type === \'authy\' ? \'Authy Code\' : \'Google Authenticator\' %></label>\n    <input type="text" name="code" value="<%= code %>" class="account-input">\n    <div id="error-code" class="error-triangle"><i class="hb hb-alert"></i></div>\n  </div>\n  <% if (twofactor_type === \'authy\') { %>\n    <div class="account-information account-support account-support-split sms-view">\n      <span class="js-send-sms">Send SMS</span>\n      <div class="sms-captcha"></div>\n      <a href="https://support.humblebundle.com/hc/en-us/articles/202421374" target="_blank">Help</a>\n    </div>\n  <% } else { %>\n    <div class="account-information account-support">\n      <a href="https://support.humblebundle.com/hc/en-us/articles/202421374" target="_blank">Help</a>\n    </div>\n  <% } %>\n<% } else { %>\n  <div class="account-information account-support">\n    <div><a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a></div>\n  </div>\n<% } %>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/PasswordConfirmationView",["require","lib/jquery/full","util/csrfUtils","util/main","account/BaseAccountView","account/SendSmsView","hbtemplate!./templates/PasswordConfirmation.html"],function(e){"use strict";var t=(e("lib/jquery/full"),e("util/csrfUtils"),e("util/main"),e("account/BaseAccountView")),n=e("account/SendSmsView"),i=e("hbtemplate!./templates/PasswordConfirmation.html"),o=function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return _inherits(i,e),_createClass(i,[{key:"getDefaultFields",value:function(e){var t=e.two_factor_required,n=e.twofactor_type;return{two_factor_required:t,twofactor_type:n,password:null,code:null}}},{key:"getSubmitData",value:function(){var e=this.model.attributes,t=e.password,n=e.code;return{password:t,code:n}}},{key:"onRender",value:function(){"authy"===this.model.get("twofactor_type")&&new n({model:this.model,el:this.$(".sms-view"),errorMessage:this.errorMessage}),t.prototype.onRender.apply(this)}},{key:"onSuccess",value:function(){this.successCallback&&this.successCallback(),this.modal.set("close",!0)}}]),i}(t);return o.prototype.captchaRequired=!0,o.prototype.cta="Confirm",o.prototype.url="/user/confirm-password",o.prototype.validations=[{id:"password",validation:function(e){return!!e},message:"Please enter your password"}],o.prototype.template=i,o}),define("lib/hbTemplate!account/templates/PasswordReset.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<% if (previous_view) { %>\n<div class="account-back-arrow js-previous">\n  <i class="hb hb-chevron-left"></i>\n</div>\n<% } %>\n<div class="account-captcha"></div>\n<div class="account-information">\n  We\'ll send a password reset link to your account\'s email address.\n</div>\n<div class="account-input-group">\n  <label for="" class="account-label">Email</label>\n  <input type="email" name="email" value="<%= email %>" class="account-input">\n  <div id="error-email" class="error-triangle"><i class="hb hb-alert"></i></div>\n</div>\n<div class="account-information account-support">\n  <a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a>\n</div>\n<div class="account-submit"></div>\n<div class="error-box"></div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/PasswordResetView",["require","lib/email-validation","account/BaseAccountView","hbtemplate!./templates/PasswordReset.html"],function(e){"use strict";var t=e("lib/email-validation"),n=e("account/BaseAccountView"),i=e("hbtemplate!./templates/PasswordReset.html"),o=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getDefaultFields",value:function(){return{email:null}}},{key:"getSubmitData",value:function(){var e=this.model.attributes.email;return{email:e}}},{key:"onSuccess",value:function(e){this.modal&&this.modal.set({active_view:"reset-confirmation",email:this.model.get("email"),use_modal_model:!0})}}]),t}(n);return o.prototype.captchaRequired=!0,o.prototype.cta="Reset Password",o.prototype.url="/user/forgot",o.prototype.validations=[{id:"email",validation:t.isValidEmail,message:"Invalid Email"}],o.prototype.template=i,o}),define("lib/hbTemplate!account/templates/LoginConfirmation.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-success">\n  <h1>Welcome Back!</h1>\n</div>\n<button type="button" name="button" class="button large account-cta green js-close-modal">Done</button>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!account/templates/SignUpConfirmation.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-success">\n  <h1>Thank you!</h1>\n  <p>\n    Your account has been successfully created! A confirmation email was sent to\n    <strong><%= email %></strong>\n  </p>\n  <p>\n    You can edit your account settings by visiting your <a href="/user/settings">user settings page</a>.\n  </p>\n</div>\n<div class="account-information account-support">\n  <a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a>\n</div>\n<button type="button" name="button" class="button large account-cta green js-close-modal">Done</button>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!account/templates/ResetConfirmation.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-success">\n  <h1>Password Reset</h1>\n  <p>\n    Your password has been successfully reset! A confirmation email was sent to\n    <strong><%= email %></strong>\n  </p>\n  <p>\n    This email may take a few minutes to arrive in your inbox.\n  </p>\n</div>\n<div class="account-information account-support">\n  <a href="https://support.humblebundle.com/hc/en-us/requests/new" target="_blank">Contact Support</a>\n</div>\n<button type="button" name="button" class="button large account-cta green js-close-modal">Done</button>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/EmailConfirmationView",["require","common/DOMLessView","hbtemplate!./templates/LoginConfirmation.html","hbtemplate!./templates/SignUpConfirmation.html","hbtemplate!./templates/ResetConfirmation.html"],function(e){"use strict";var t=e("common/DOMLessView"),n=e("hbtemplate!./templates/LoginConfirmation.html"),i=e("hbtemplate!./templates/SignUpConfirmation.html"),o=e("hbtemplate!./templates/ResetConfirmation.html"),s=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(e){var t=e.attributes;this.model=t.model}}]),t}(t);s.prototype.className="account-view account-confirmation";var a=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),t}(s);a.prototype.template=n;var r=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),t}(s);r.prototype.template=i;var l=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),t}(s);return l.prototype.template=o,{LoginConfirmationView:a,ResetConfirmationView:l,SignUpConfirmationView:r}}),define("lib/hbTemplate!account/templates/Modal.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="account-modal-outer">\n  <div class="top-bar">\n    <div>\n      <img src="xSTATIC_URLx/static/hashed/6b381fb0a8470825c2ab43057420a078c3897c6d.svg" class="logo">\n    </div>\n    <div class="close-modal js-close-modal">\n      <i class="hb hb-times"/>\n    </div>\n  </div>\n  <div class="account-modal-inner"></div>\n</div>\n'.replace(/xSTATIC_URLx/g,t)}()});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();define("account/Modal",["require","lib/jquery/full","lib/lodash","backbone","lib/backbone.modal","util/main","account/AccountStartView","account/SignUpView","account/LoginView","account/HumbleGuardView","account/PasswordConfirmationView","account/PasswordResetView","account/TwoFactorView","account/EmailConfirmationView","hbtemplate!./templates/Modal.html"],function(e){"use strict";var t=e("lib/jquery/full"),n=e("lib/lodash"),i=e("backbone"),o=(e("lib/backbone.modal"),e("util/main")),s=e("account/AccountStartView"),a=e("account/SignUpView"),r=e("account/LoginView"),l=e("account/HumbleGuardView"),c=e("account/PasswordConfirmationView"),u=e("account/PasswordResetView"),d=e("account/TwoFactorView"),h=e("account/EmailConfirmationView"),m=e("hbtemplate!./templates/Modal.html"),p=function(e){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,e),_createClass(n,[{key:"initialize",value:function(){this.model=new i.Model,this.previousViews=[],this.listenTo(this.model,"change:active_view",this.updateView.bind(this)),this.listenTo(this.model,"change:close",this.closeView.bind(this))}},{key:"beforeSubmit",value:function(e){return this.currentView.onSubmit(e),!1}},{key:"closeView",value:function(){this.model.get("close")&&this.destroy()}},{key:"setActive",value:function(){this.currentView.modal=this.model}},{key:"triggerView",value:function(e){i.Modal.prototype.triggerView.call(this,e),this.previousView&&(this.doNotPushPrevious||this.previousViews.push(this.previousView.constructor),this.previousView.remove()),this.currentView.model&&this.currentView.model.set("previous_view",!!this.previousViews.length),this.doNotPushPrevious=!1}},{key:"updateView",value:function(){var e={name:this.model.get("active_view")};this.model.get("use_modal_model")&&(this.attributes.model=this.model),this.openAt(e)}},{key:"beforeCancel",value:function(){this.model.get("goto")&&o.redirectInDomain(this.model.get("goto"))}},{key:"navigateBack",value:function(){this.previousViews.length&&(this.doNotPushPrevious=!0,this.openAt({view:this.previousViews.pop()}))}},{key:"onRender",value:function(){this.attributes&&this.attributes.isMobile&&t("html, body").addClass("fixed-height")}},{key:"onShow",value:function(){var e=this.$("input[type=text], input[type=email], input[type=password]");e.length&&e[0].focus(),"AccountStartView"===this.currentView.constructor.name&&this.$(".account-modal-outer").addClass("account-reveal-background-image")}},{key:"onDestroy",value:function(){this.attributes&&this.attributes.isMobile&&t("html, body").removeClass("fixed-height")}}]),n}(i.Modal);return p.prototype.cancelEl=".js-close-modal",p.prototype.events={"click .js-previous":"navigateBack"},p.prototype.prefix="account-bbm",p.prototype.template=n.template(m),p.prototype.viewContainer=".account-modal-inner",p.prototype.views={"account-start":{view:s,name:"account-start"},"click .js-account-signup":{view:a,name:"signup",onActive:"setActive"},"click .js-account-login":{view:r,name:"login",onActive:"setActive"},guard:{view:l,name:"guard",onActive:"setActive"},"click .js-password-reset":{view:u,name:"reset",onActive:"setActive"},"password-confirmation":{view:c,name:"password-confirmation",onActive:"setActive"},"login-confirmation":{view:h.LoginConfirmationView,name:"login-confirmation"},"signup-confirmation":{view:h.SignUpConfirmationView,name:"signup-confirmation"},"reset-confirmation":{view:h.ResetConfirmationView,name:"reset-confirmation"},twofactor:{view:d,name:"twofactor",onActive:"setActive"}},function(e){var n=e.name,i=e.attributes,o=e.successCallback,s=e.destroyCallback;i=i||{};var a=new p({attributes:i});a.render({name:n}),a.currentView.successCallback=o,a.currentView.destroyCallback=s,t("#site-modal").html(a.$el)}}),define("lib/hbTemplate!remindMe/templates/RemindMeIconView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<a href="#" class="js-remind-button save-button">\n  <span class="hb hb-bell-o not-saved-icon js-bell"></span>\n  <span class="hb hb-bell saved-icon js-bell" title="Remind Me"></span>\n  <i class="js-spinner inline-spinner dark-spinner hidden"></i>\n</a>\n<span class="error-box js-error-box"></span>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("remindMe/views",["require","util/csrfUtils","common/DOMLessView","account/Modal","hbtemplate!../remindMe/templates/RemindMeIconView.html"],function(e){"use strict";var t=e("util/csrfUtils"),n=e("common/DOMLessView"),i=e("account/Modal"),o=e("hbtemplate!../remindMe/templates/RemindMeIconView.html"),s="Error! Couldn't set your preference.",a="Ending too soon for a reminder. Get it now!",r="OK! We'll remind you when this is almost over.",l="Reminder has been removed.",c=function(){window._gaTrackEvent&&_gaTrackEvent.apply(null,arguments)},u=n.extend({className:"remind-me-icon-view save-for-later",template:o,ui:{remindButton:".js-remind-button",bellIcons:".js-bell",spinner:".js-spinner",errorBox:".js-error-box"},events:{"click @ui.remindButton":"toggleRemind"},initialize:function(e){this.productMachineName=e.productMachineName,this.productHumanName=e.productHumanName,this.isLoggedIn=e.isLoggedIn,this.model||(this.model=new Backbone.Model({isReminded:e.isReminded})),this.model.on("change:isReminded",this.toggleRemindState,this),this.postBody=_defineProperty({product_machine_name:this.productMachineName},t.formKey,t.getCsrf())},onRender:function(){this.toggleRemindState()},toggleRemind:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.model.get("isReminded")?this.unremind():this.isLoggedIn?this.remind():i({name:"login",attributes:window.modal_attributes})},toggleRemindState:function(){this.model.get("isReminded")?this.showReminded():this.showUnreminded()},showReminded:function(){this.ui.remindButton.addClass("saved")},showUnreminded:function(){this.ui.remindButton.removeClass("saved")},showProcessing:function(){this.ui.bellIcons.addClass("hidden"),this.ui.spinner.removeClass("hidden")},hideProcessing:function(){this.ui.bellIcons.removeClass("hidden"),this.ui.spinner.addClass("hidden")},remind:function(){c("Remind Me","Reminder Set",this.productMachineName),this.showProcessing(),$.post("/bundle/remindme",$.extend({action:"add"},this.postBody)).success(function(e){e.success?this.onRemindSuccess():"toosoon"==e.msg?this.onCutOffReached():this.onGeneralError()}.bind(this)).error(function(){this.onGeneralError()}.bind(this)).done(function(){this.hideProcessing()}.bind(this))},onRemindSuccess:function(){this.model.set("isReminded",!0),this.showAndFade(r)},onUnremindSuccess:function(){this.model.set("isReminded",!1),this.showAndFade(l)},onCutOffReached:function(){this.ui.errorBox.text(a).show().delay(1e3).queue(function(){this.$el.fadeOut()}.bind(this))},onGeneralError:function(){this.showAndFade(s)},showAndFade:function(e){this.ui.errorBox.text(e).show().delay(1500).fadeOut()},unremind:function(){c("Remind Me","Reminder Removed",this.productMachineName),this.showProcessing(),$.post("/bundle/remindme",$.extend({action:"remove"},this.postBody)).success(function(e){e.success?this.onUnremindSuccess():this.onGeneralError()}.bind(this)).error(function(){this.onGeneralError()}.bind(this)).done(function(){this.hideProcessing()}.bind(this))}});return{RemindMeIconView:u}}),define("lib/hbTemplate!wishlist/templates/WishlistIconView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<a href="#" class="js-wishlist-button save-button">\n  <span class="hb hb-star-o not-saved-icon js-star"></span>\n  <span class="hb hb-star saved-icon js-star"></span>\n  <i class="js-spinner inline-spinner dark-spinner hidden"></i>\n</a>\n<span class="error-box js-error-box"></span>\n'.replace(/xSTATIC_URLx/g,t);
}()}),define("wishlist/views",["require","util/csrfUtils","account/Modal","common/DOMLessView","hbtemplate!../wishlist/templates/WishlistIconView.html"],function(e){"use strict";var t=e("util/csrfUtils"),n=e("account/Modal"),i=e("common/DOMLessView"),o=e("hbtemplate!../wishlist/templates/WishlistIconView.html"),s="Error! Couldn't edit your wishlist.",a="We'll email you when this goes on sale.",r="Removed from wishlist.",l=function(){window._gaTrackEvent&&_gaTrackEvent.apply(null,arguments)},c=i.extend({className:"wishlist-icon-view save-for-later",template:o,ui:{wishlistButton:".js-wishlist-button",starIcons:".js-star",spinner:".js-spinner",errorBox:".js-error-box"},events:{"click @ui.wishlistButton":"toggleWishlist"},initialize:function(e){this.productMachineName=e.productMachineName,this.productHumanName=e.productHumanName,this.isLoggedIn=e.isLoggedIn,this.isWishlisted=e.isWishlisted,this.postBody=_defineProperty({},t.formKey,t.getCsrf())},serializeData:function(){return{isWishlisted:this.isWishlisted}},onRender:function(){this.toggleWishlistState()},toggleWishlist:function(e){e&&e.preventDefault(),this.isWishlisted?this.removeFromWishlist():this.isLoggedIn?this.addToWishlist():n({name:"login",attributes:window.modal_attributes})},toggleWishlistState:function(){this.isWishlisted?this.showWishlisted():this.showNotWishlisted()},showWishlisted:function(){this.ui.wishlistButton.addClass("saved")},showNotWishlisted:function(){this.ui.wishlistButton.removeClass("saved")},showProcessing:function(){this.ui.starIcons.addClass("hidden"),this.ui.spinner.removeClass("hidden")},hideProcessing:function(){this.ui.starIcons.removeClass("hidden"),this.ui.spinner.addClass("hidden")},addToWishlist:function(){l("Add to Wishlist Element","Product Added to Wishlist",this.productMachineName+"|"+location.pathname),this.showProcessing(),$.ajax({method:"POST",url:"/wishlist/add/"+this.productMachineName,data:this.postBody,dataType:"json"}).success(function(e){e.success?this.onAddedSuccess():e.error&&this.onSpecificError(e.error)}.bind(this)).error(function(){this.onGeneralError()}.bind(this)).done(function(){this.hideProcessing()}.bind(this))},onAddedSuccess:function(){this.isWishlisted=!0,this.toggleWishlistState(),this.showAndFade(a)},onRemovedSuccess:function(){this.isWishlisted=!1,this.toggleWishlistState(),this.showAndFade(r)},onSpecificError:function(e){this.showAndFade(e)},onGeneralError:function(){this.showAndFade(s)},showAndFade:function(e){this.ui.errorBox.text(e).show().delay(1500).fadeOut()},removeFromWishlist:function(){l("Remove from Wishlist Element","Product Removed from Wishlist",this.productMachineName+"|"+location.pathname),this.showProcessing(),$.ajax({method:"POST",url:"/wishlist/remove/"+this.productMachineName,data:this.postBody,dataType:"json"}).success(function(e){e.success?this.onRemovedSuccess():e.error&&this.onSpecificError(e.error)}.bind(this)).error(function(){this.onGeneralError()}.bind(this)).done(function(){this.hideProcessing()}.bind(this))}});return{WishlistIconView:c}}),define("lib/hbTemplate!common/productTiles/templates/CustomHtmlTileView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return"<style>\n<%= _l.unescape(tile_css) %>\n</style>\n<%= _l.unescape(tile_html) %>".replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/FullTileView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="js-tile-view simple-tile-view <%- size %>"></div>\n<div class="tile-info <%- type %>">\n  <div class="primary info-section">\n    <a class="name" href="<%- product_url %>"><%- tile_name %></a>\n    <div class="remind-me js-remind-me"></div>\n  </div>\n  <a class="secondary info-section" href="<%- product_url %>">\n<% if (highlights) { %>\n    <div class="highlights">\n  <% _l.each(highlights, function(highlight) { %>\n      <span class="highlight"><%- highlight %></span>\n  <% }) %>\n    </div>\n<% } %>\n    <div class="js-countdown-view full-countdown-view"></div>\n  </a>\n</div>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/ImageGridView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="hero-background-side-fadeout"></div>\n<div class="hero-background-overlay"></div>\n<div class="hero-background">\n<% if (useGridBackground) { %>\n  <ul class="image-grid">\n  <% _l.each(gridImages, function(image) { %>\n    <li class="image-grid-item-container">\n      <img class="image-grid-item" src="<%- image %>"/>\n    </li>\n  <% }); %>\n  </ul>\n<% } else { // TODO ENG-13708 this logic should not be part of this template %>\n  <div class="hero-background-image" style="background-image: url(<%- high_res_tile_image %>)"></div>\n<% } %>\n</div>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/HeroTileView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="hero-background-container">\n</div>\n<% if (!isOnBundlePage) { %>\n<a href="<%- product_url %>" class="hero-invisible-link">\n<% } %>\n<% if (isOnBundlePage) { %>\n<div class="js-hero-charity hero-charity-container"></div>\n<% } %>\n<div class="hero-foreground-container">\n  <div class="hero-foreground">\n<% if (type == \'bundle\') { %>\n  <% if (tile_stamp && tile_logo) { %>\n    <div class="tile-stamp-and-logo">\n        <span class="stamp <%- tile_stamp %>"></span>\n        <div class="hero-bundle-logo" style="background-image: url(\'<%- tile_logo %>\')"></div>\n    </div>\n    <% } if (tile_name) { %>\n    <div class="tile-name bold-upper"><%- tile_name %></div>\n    <% } %>\n    <% // note: do not escape blurbs as monthly overrides contain html %>\n  <% if (marketing_blurb) { %>\n    <p class="marketing-blurb"><%= marketing_blurb %></p>\n  <% } %>\n  <% if (detailed_marketing_blurb) { %>\n    <p class="detailed-marketing-blurb"><%= detailed_marketing_blurb %></p>\n  <% } %>\n  <div class="hero-highlights">\n  <% _l.each(hero_highlights, function(highlight, index) { %>\n      <div class="highlight-container">\n      <% if (index !== 0) { %>\n        <div class="highlight-divider"><i class="hb hb-circle"></i></div>\n      <% } %>\n        <div class="highlight-popup-container">\n          <span class="highlight bold-upper"><%- highlight.heading %></span>\n      <% if (highlight.tooltip) { %>\n          <span class="highlight-popup"><%- highlight.tooltip %></span>\n      <% } %>\n        </div>\n      </div>\n  <% }) %>\n    <div class="highlight-divider"><i class="hb hb-circle"></i></div>\n    <span class="highlight bold-upper"><span class="js-bundles-sold"><%- bundlesSold %></span> Bundles Sold</span>\n  </div>\n  <div class="cta-button rectangular-button button-v2 green hero-cta">Get The Bundle</div>\n  <div class="time-left bold-upper">TIME LEFT</div>\n  <% if (isOnBundlePage) { %>\n  <div class="hero-countdown-container">\n    <div class="hero-remindme-container">\n      <div class="remind-me js-hero-remind-me"></div>\n      <div class="remind-me-text">REMIND</div>\n    </div>\n  <% } %>\n    <div class="js-countdown-view full-countdown-view"></div>\n  <% if (isOnBundlePage) { %>\n  </div>\n  <% } %>\n<% } %>\n  </div>\n</div>\n<% if (!isOnBundlePage) { %>\n</a>\n<% } %>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/FullStoreTileView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="js-tile-view simple-tile-view"></div>\n<div class="tile-info <%- type %>">\n  <div class="primary info-section">\n    <a class="name" href="<%- product_url %>"><%- tile_name %></a>\n    <span class="wishlist js-wishlist"></span>\n  </div>\n  <div class="secondary info-section">\n    <div class="devices">\n      <ul class="combined-platforms-operating-systems-list no-style-list">\n<% _l.each(combinedPlatformAndOSList, function(combinedPlatformAndOSList) { %>\n        <li class="platform-os hb <%- combinedPlatformAndOSList.icon %>"\n          title="<%- combinedPlatformAndOSList.humanName %>"></li>\n<% }); %>\n<% if (extraDeviceCount) { %>\n        <li class="hb extraDeviceCount" title="<%- extraDeviceCount %>">+<%- extraDeviceCount %></li>\n<% } %>\n      </ul>\n      </ul>\n    </div>\n    <div class="price">\n<% if (discount > 0) { %>\n      <span class="button-v2 rectangular-button green discount-percentage">-<%- discount %>%</span>\n<% } %>\n      <a class="button-v2 clear-button rectangular-button green buy-button" href="<%- product_url %>"><%- currentPrice %></a>\n    </div>\n  </div>\n</div>\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/SimpleCountdownView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<div class="js-simple-countdown-timer timer-wrapper button-v2 oval-button black">\n  <span class="js-days timer-field"></span>\n</div>\n<div class="js-countdown-timer timer-wrapper button-v2 oval-button red hidden">\n  <span class="js-days timer-field"></span><span class="timer-separator">:</span><span class="js-hours timer-field"></span><span class="timer-separator">:</span><span class="js-minutes timer-field"></span><span class="timer-separator">:</span><span class="js-seconds timer-field"></span>\n</div>\n<div class="js-hero-countdown-timer hidden">\n  <div class="hero-timer-item button-v2 rectangular-button">\n    <span class="js-days timer-field"></span>\n    <div class="timer-unit">days</div>\n  </div>\n  <div class="hero-timer-item button-v2 rectangular-button">\n    <span class="js-hours timer-field"></span>\n    <div class="timer-unit">hrs</div>\n  </div>\n  <div class="hero-timer-item button-v2 rectangular-button">\n    <span class="js-minutes timer-field"></span>\n    <div class="timer-unit">min</div>\n  </div>\n  <div class="hero-timer-item button-v2 rectangular-button">\n    <span class="js-seconds timer-field"></span>\n    <div class="timer-unit">sec</div>\n  </div>\n</div>'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/SimpleTileView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<a href="<%- product_url %>" class="image-link">\n<% if (shouldLoadHighResImage) { %>\n\n\n  <img\n    class="js-tile-image tile-image js-lazyload"\n    data-srcset="\n      <%- tile_image %> 616w,\n      <%- high_res_tile_image %> 1200w,\n      <%- tile_image %> 1232w,\n      <%- high_res_tile_image %> 2400w\n    "\n    sizes="(min-width: 48em) 1200px, 616px"\n    data-src="<%- tile_image %>"\n  />\n<% } else { %>\n  <img class="js-tile-image tile-image js-lazyload" data-src="<%- tile_image %>" />\n<% } %>\n<% if (tile_stamp || tile_logo || showInfo) { %>\n  <div class="tile-overlay">\n    <div class="tile-stamp-and-logo">\n  <% if (tile_stamp) { %>\n      <span class="stamp <%- tile_stamp %>"></span>\n  <% } %>\n  <% if (tile_logo) { %>\n    <span class="logo" style="background-image: url(\'<%- tile_logo %>\')"></span>\n  <% } %>\n    </div>\n  <% if (showInfo) { %>\n      <div class="js-tile-info tile-info">\n        <div class="js-countdown-view full-countdown-view" />\n        <span class="name"><%- tile_name %></span>\n      </div>\n  <% } %>\n  </div>\n<% } %>\n</a>\n<% if (!_l.isEmpty(moreDetails)) { %>\n<a href="<%- product_url %>" class="more-details">\n  <div class="content">\n    <h2 class="title"><%= moreDetails.title %></h2>\n    <% // note: do not escape blurbs as monthly overrides contain html %>\n    <p class="marketing-blurb"><%= moreDetails.marketingBlurb %></p>\n    <p class="detailed-marketing-blurb"><%= moreDetails.detailedMarketingBlurb %></p>\n    <p class="highlights">\n  <% _l.each(moreDetails.contentHighlights, function(highlight) { %>\n      <span class="highlight"><%= highlight %></span>\n  <% }); %>\n    </p>\n  </div>\n</a>\n<% } %>\n\n'.replace(/xSTATIC_URLx/g,t)}()}),define("lib/hbTemplate!common/productTiles/templates/HeroCharityView.html",function(){return function(){var e="www.humblebundle.com"===window.location.hostname,t=e?"https://humblebundle-a.akamaihd.net":"";return'<% if (charities) { %>\n  <div class="hero-charity-box">\n  <% if (numHiddenCharities > 0) { %>\n  <div class="hero-hidden-charities-container hero-charity-blurb">\n    <div class="hero-hidden-charities">\n        &#43;<%- numHiddenCharities %>\n    </div>\n  </div>\n  <% } %>\n  <div class="hero-charity-content">\n    <% _l.each(charities, function(charity) { %>\n      <div class="hero-charity-item">\n        <div class="hero-charity-logo"><img src="<%- charity.logoUrl %>" alt=""></div>\n      </div>\n    <% }) %>\n  </div>\n  <div class="hero-charity-blurb hero-supporting">Supporting</div>\n</div>\n<% } %>'.replace(/xSTATIC_URLx/g,t)}()});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("common/productTiles/views",["require","lib/lodash","lib/moment","util/main","pubnub","constants/platformAndDelivery","common/DOMLessView","remindMe/views","wishlist/views","common/productTiles/constants","hbtemplate!../productTiles/templates/CustomHtmlTileView.html","hbtemplate!../productTiles/templates/FullTileView.html","hbtemplate!../productTiles/templates/ImageGridView.html","hbtemplate!../productTiles/templates/HeroTileView.html","hbtemplate!../productTiles/templates/FullStoreTileView.html","hbtemplate!../productTiles/templates/SimpleCountdownView.html","hbtemplate!../productTiles/templates/SimpleTileView.html","hbtemplate!../productTiles/templates/HeroCharityView.html"],function(e){"use strict";var t=e("lib/lodash"),n=e("lib/moment"),i=e("util/main"),o=e("pubnub"),s=e("constants/platformAndDelivery"),a=e("common/DOMLessView"),r=e("remindMe/views"),l=e("wishlist/views"),c=e("common/productTiles/constants"),u=e("hbtemplate!../productTiles/templates/CustomHtmlTileView.html"),d=e("hbtemplate!../productTiles/templates/FullTileView.html"),h=e("hbtemplate!../productTiles/templates/ImageGridView.html"),m=e("hbtemplate!../productTiles/templates/HeroTileView.html"),p=e("hbtemplate!../productTiles/templates/FullStoreTileView.html"),f=e("hbtemplate!../productTiles/templates/SimpleCountdownView.html"),b=e("hbtemplate!../productTiles/templates/SimpleTileView.html"),v=e("hbtemplate!../productTiles/templates/HeroCharityView.html"),g=[c.TILE_SIZES.THREE_FOURTHS,c.TILE_SIZES.FULL,c.TILE_SIZES.HERO],w=[c.TILE_SIZES.QUARTER,c.TILE_SIZES.ONE_THIRD],y=5,_=function(e,t){if((t.stats||t.stats.numberofcontributions)&&!(e.lastUpdatedPubnubTimestamp>t.timestamp)){e.lastUpdatedPubnubTimestamp=t.timestamp;var n=parseInt(t.stats.numberofcontributions.total);e.model.set("bundles_sold",n),"object"===_typeof(e.ui.numBundlesSold)&&e.ui.numBundlesSold.text(i.numberWithCommas(n))}},C=function(e){o.subscribe({channel:"humble"+e.model.get("machine_name"),callback:function(t){return _(e,t)}})},k=a.extend({className:function(){return["simple-tile-view",this.size,this.model.get("type")].join(" ")},ui:{tileImage:".js-tile-image",numBundlesSold:".js-bundles-sold"},template:b,showInfo:!1,hmbParams:null,initialize:function(e){a.prototype.initialize.apply(this,arguments),this.size=e.size,this.showContentHighlights=void 0==e.showContentHighlights||e.contentHighlights,this.showContentHighlights&&this.model.get("type")===c.PRODUCT_TYPES.BUNDLE&&C(this)},setHMBParams:function(e){this.hmbParams=e},serializeData:function(){var e=a.prototype.serializeData.apply(this,arguments);return t.extend(e,{moreDetails:this.getMoreDetails(),shouldLoadHighResImage:t.includes(g,this.size),showInfo:this.showInfo}),this.hmbParams&&(e.product_url=e.product_url+"?"+this.hmbParams),e},getMoreDetails:function(){var e=this.model.get("type"),n=this.model.get("is_custom");if(n)return{marketingBlurb:this.model.get("marketing_blurb"),detailedMarketingBlurb:this.model.get("detailed_marketing_blurb"),title:this.model.get("product_title"),contentHighlights:this.showContentHighlights?this.model.get("highlights"):[]};if(t.includes([c.PRODUCT_TYPES.COUPON,c.PRODUCT_TYPES.STORE],e))return{};var o={marketingBlurb:this.model.get("marketing_blurb")};o.detailedMarketingBlurb=this.model.get("detailed_marketing_blurb");var s=i.numberWithCommas(this.model.get("bundles_sold")),a=this.model.get("hover_title"),r=this.model.get("hover_highlights")||[];if(e===c.PRODUCT_TYPES.BUNDLE){var l=""+s;t.includes(this.className(),"navbar-tile")&&(l="~"+l),r.push('<span class="js-bundles-sold">'+l+"</span> Sold")}return $.extend(!0,o,{title:a,contentHighlights:this.showContentHighlights?r:[]}),o},onRender:function(){this.$el.attr("class",this.className())}}),T=k.extend({className:function e(){var e=k.prototype.className.apply(this,arguments),t=[e,"navbar-tile"];return this.model.get("is_active")&&t.push("is-active"),t.join(" ")},ui:t.extend({},k.prototype.ui,{countdownTimer:".js-countdown-view"}),showInfo:!0,initialize:function(e){k.prototype.initialize.apply(this,arguments),this.countdownView=new x({model:e.model})},onRender:function(){k.prototype.onRender.apply(this,arguments),this.ui.countdownTimer.append(this.countdownView.render().el)}}),S=a.extend({className:function(){return["full-tile-view",this.size,this.model.get("type")].join(" ")},hmbParams:null,template:!1,ui:{tileView:".js-tile-view"},initialize:function(e){this.user=e.user,this.size=e.size,this.tile=new k({model:e.model,size:this.size})},setPositionDetails:function(e,t,n,i,o){var s={hmb_source:o,hmb_medium:"product_tile",hmb_campaign:"mosaic_section_"+e+"_layout_index_"+t+"_layout_type_"+n+"_tile_index_"+i};this.hmbParams=$.param(s),this.tile.setHMBParams(this.hmbParams)},serializeData:function(){var e=a.prototype.serializeData.apply(this,arguments);return t.includes(w,this.size)&&this.model.get("tile_short_name")&&(e.tile_name=this.model.get("tile_short_name")),this.hmbParams&&(e.product_url=e.product_url+"?"+this.hmbParams),e},onRender:function(){this.$el.attr("class",this.className()),this.tile.setElement(this.ui.tileView).render()}}),O=a.extend({className:"hero-charity-box-container",events:{"click .hero-hidden-charities-container":"expandBox","click .hero-charity-content":"scrollToCharity","click .hero-supporting":"scrollToCharity","mouseenter .hero-charity-content":"expandBox","mouseleave .hero-charity-content":"collapseBox"},ui:{charityEl:".js-hero-charity-view"},template:v,initialize:function(e){this.charities=e.charities,this.smoothScroller=e.smoothScroller,this.isOnBundlePage=e.isOnBundlePage},serializeData:function(){var e=a.prototype.serializeData.apply(this,arguments);return e.charities=this.charities,e.numHiddenCharities=this.charities.length-2,e.isOnBundlePage=this.isOnBundlePage,e},onRender:function(){1===this.charities.length&&this.$el.addClass("single-charity")},expandBox:function(){this.$el.addClass("expanded-charity-box")},collapseBox:function(){this.$el.removeClass("expanded-charity-box")},scrollToCharity:function(){this.smoothScroller&&this.smoothScroller.scrollToCharity()}}),x=a.extend({className:"timer",ui:{simpleCountdownTimer:".js-simple-countdown-timer",expandedCountdownTimer:".js-countdown-timer",heroCountdownTimer:".js-hero-countdown-timer",heroCountdownTimerItem:".hero-timer-item",daysView:".js-days",hoursView:".js-hours",minsView:".js-minutes",secView:".js-seconds"},template:f,initialize:function(e){this.hero=e.hero,this.seconds=0,this.days=0,this.hours=0,this.minutes=0,this.showFullTime=!1,this.endDate=n.utc(this.model.getEndDate())},formatNumberToString:function(e){return e>0?e>9?""+e:"0"+e:"00"},getCurrentDate:function(){return n()},getDays:function(){return this.endDate.diff(this.getCurrentDate(),"days")},getHours:function(){return this.endDate.diff(this.getCurrentDate(),"hours")%24},getMinutes:function(){return this.endDate.diff(this.getCurrentDate(),"minutes")%60},getSeconds:function(){return this.endDate.diff(this.getCurrentDate(),"seconds")%60},switchVisiblityofExpandedTimer:function(){this.ui.expandedCountdownTimer.removeClass("hidden"),this.ui.simpleCountdownTimer.addClass("hidden")},switchVisiblityofHeroTimer:function(){this.ui.heroCountdownTimer.removeClass("hidden"),this.ui.simpleCountdownTimer.addClass("hidden")},switchHeroTimerToRed:function(){this.ui.heroCountdownTimerItem.addClass("ending-soon")},updateFullTimer:function(){this.ui.secView.text(this.formatNumberToString(this.getSeconds())),this.ui.minsView.text(this.formatNumberToString(this.getMinutes())),this.ui.hoursView.text(this.formatNumberToString(this.getHours())),this.ui.daysView.text(this.formatNumberToString(this.getDays()))},updateSimpleTimer:function(){this.ui.daysView.text(this.getDays()+" Days Left")},updateCountdown:function(){this.hero&&(this.getDays()<2&&this.switchHeroTimerToRed(),this.switchVisiblityofHeroTimer()),this.showFullTime||this.hero||this.getDays()<2&&(this.showFullTime=!0,this.switchVisiblityofExpandedTimer()),this.showFullTime||this.hero?this.updateFullTimer():this.updateSimpleTimer()},onRender:function(){this.updateCountdown(),setInterval(this.updateCountdown.bind(this),500)}}),R=S.extend({template:d,ui:t.extend({},S.prototype.ui,{remindMe:".js-remind-me",countdownTimer:".js-countdown-view"}),serializeData:function(){var e=S.prototype.serializeData.apply(this,arguments);return e},initialize:function(){S.prototype.initialize.apply(this,arguments);var e=!0;if(this.model.get("type")===c.PRODUCT_TYPES.MONTHLY&&this.user.get("monthlyWillReceiveFutureMonths"))e=!1;else if(this.model.get("is_custom"))e=!1;else{var i=n(this.model.getEndDate()),o=i.subtract("days",2),s=n();e=s.isBefore(o)}if(e){var a=this.user.get("remindMeProducts");this.remindMeView=new r.RemindMeIconView({productMachineName:this.model.get("machine_name"),productHumanName:this.model.get("human_name"),isLoggedIn:this.user.isLoggedIn(),isReminded:t.includes(a,this.model.get("machine_name"))})}this.model.getEndDate()&&(this.countdownView=new x({model:this.model}))},onRender:function(){S.prototype.onRender.apply(this,arguments),this.remindMeView&&this.ui.remindMe.append(this.remindMeView.render().el),this.countdownView&&this.ui.countdownTimer.append(this.countdownView.render().el)}}),P=a.extend({template:h,ui:{imageGrid:".image-grid"},serializeData:function(){var e=a.prototype.serializeData.apply(this,arguments),t=this.model.get("image_grid_urls")||[];return e.gridImages=this.composeGrid(t),e},initialize:function(e){var t=this,n=e.useGridBackground;this.model.set("useGridBackground",n);var i=e.fadeInterval,o=e.fadeDuration||1e3;n&&i&&setTimeout(function(){t.ui.imageGrid.fadeOut(o).fadeIn(o),setInterval(function(){t.ui.imageGrid.fadeOut(o).fadeIn(o)},i)},i-o)},onRender:function(){this.ui.imageGrid.addClass(this.model.get("image_grid_item_width")===c.HERO_GRID.GAME_WIDTH?"game-grid":"portrait-grid");var e=!!window.chrome&&!!window.chrome.webstore,t="Win32"===window.navigator.platform;window.devicePixelRatio>=1.5&&e&&t&&this.$el.addClass("high-dpi-chrome-windows")},composeGrid:function(e){for(var n=2,i=2,o=this.model.get("image_grid_item_width"),s=this.model.get("image_grid_item_height"),a=o===c.HERO_GRID.GAME_WIDTH?3080:3e3,r=6*window.innerHeight,l=Math.ceil(a/o),u=Math.ceil(r/s),d=[],h=0;h<=u;h++){for(var m=[],p=(h%n*e.length/n+h/n*i)%e.length,f=l;f>0;){var b=e.length-p;if(b<0)return[];var v=Math.min(f,b);m=m.concat(e.slice(p,p+v)),f-=v,p=(p+v)%e.length}d.push(m)}return t.flattenDeep(d)}}),j=a.extend({className:function(){return["hero-tile-view","hero",this.model.get("type")].join(" ")},hmbParams:null,template:m,ui:{countdownTimer:".js-countdown-view",heroBackground:".hero-background-container",charityEl:".js-hero-charity",numBundlesSold:".js-bundles-sold",remindMe:".js-hero-remind-me",remindMeContainer:".hero-remindme-container"},events:{"click .hero-cta":"scrollToCheckout"},serializeData:function(){var e=a.prototype.serializeData.apply(this,arguments);return e.isOnBundlePage=this.isOnBundlePage,e.hero_highlights=this.model.get("hero_highlights"),e.bundlesSold=i.numberWithCommas(this.model.get("bundles_sold")),this.hmbParams&&(e.product_url=e.product_url+"?"+this.hmbParams),e},initialize:function(){C(this),this.backgroundView=new P({model:this.model,useGridBackground:"bundle"===this.model.get("type"),fadeInterval:75e3,fadeDuration:1e3}),this.countdownView=new x({model:this.model,hero:!0}),this.smoothScroller=this.options.smoothScroller,this.isOnBundlePage=this.options.isOnBundlePage,this.hasBanner=this.options.hasBanner,this.remindMeView=new r.RemindMeIconView(this.options.remindMeOptions),this.charityView=new O({charities:this.options.charities,isOnBundlePage:this.isOnBundlePage,smoothScroller:this.smoothScroller}),this.hasBanner=this.options.hasBanner},setPositionDetails:function(e,t,n,i,o){var s={hmb_source:o,hmb_medium:"product_tile",hmb_campaign:"mosaic_section_"+e+"_layout_index_"+t+"_layout_type_"+n+"_tile_index_"+i};this.hmbParams=$.param(s)},scrollToCheckout:function(){this.smoothScroller&&this.smoothScroller.scrollToCheckout()},shouldDisplayRemindMe:function(){var e=n.utc(this.model.getEndDate()),t=n();return e.diff(t,"days")>=2},onRender:function(){this.$el.attr("class",this.className()),this.hasBanner&&this.$el.addClass("with-banner"),this.ui.countdownTimer.append(this.countdownView.render().el),this.shouldDisplayRemindMe()?(this.ui.remindMe.append(this.remindMeView.render().el),this.ui.countdownTimer.addClass("remindme-visible")):this.ui.remindMeContainer.addClass("hidden"),this.backgroundView.setElement(this.ui.heroBackground).render(),this.ui.charityEl.append(this.charityView.render().el)}}),E=S.extend({template:p,ui:t.extend({},S.prototype.ui,{wishlist:".js-wishlist"}),initialize:function(e){S.prototype.initialize.apply(this,arguments);var n=this.user.get("wishlist");this.wishlistView=new l.WishlistIconView({productMachineName:this.model.get("machine_name"),productHumanName:this.model.get("human_name"),isLoggedIn:this.user.isLoggedIn(),isWishlisted:t.includes(n,this.model.get("machine_name"))})},onRender:function(){S.prototype.onRender.apply(this,arguments),this.ui.wishlist.append(this.wishlistView.render().el)},serializeData:function(){var e=S.prototype.serializeData.apply(this,arguments),n=this.getPlatformInfo(),i=this.getOperatingSystems(),o=this.model.getDisplayCurrentPrice(),s=this.model.getHumanDiscount(),a=t.union(n,i),r=0;return a.length>y&&this.size==c.TILE_SIZES.QUARTER&&(r=a.length-y-1),$.extend(!0,e,{combinedPlatformAndOSList:a,extraDeviceCount:r,currentPrice:o,discount:s}),e},getPlatformInfo:function(){var e=void 0,n=t.map(this.model.get("platforms"),function(t){return e=s.delivery_method_definition_dict[t],e?{icon:e.icon,humanName:e.human_name,importance:e.importance||99}:{}});return t.sortBy(t.without(n,{}),function(e){return e.importance})},getOperatingSystems:function(){var e=void 0,n=t.map(this.model.get("operating_systems"),function(t){return e=s.platform_definition_dict[t],e?{icon:e.icon,humanName:e.human_name,importance:e.importance||99}:{}});return t.sortBy(t.without(n,{}),function(e){return e.importance})}}),V=a.extend({className:function(){return["custom-tile-html-view"].join(" ")},template:u,initialize:function(e){a.prototype.initialize.apply(this,arguments),this.size=e.size},onRender:function(){this.$el.attr("class",this.className())},setPositionDetails:function(){}});return{BaseFullTileView:S,FullTileView:R,HeroTileView:j,ImageGridView:P,FullStoreTileView:E,SimpleCountDownView:x,SimpleTileView:k,NavBarTileView:T,CustomHTMLTileView:V,setBundlesSoldCountFromPubnub:_}}),define("navbar/views/BundleDropdownView",["require","lib/lodash","common/productTiles/constants","lib/lazyLoad","lib/disableBodyScroll","common/DOMLessView","hbtemplate!../templates/BundleDropdownView.html","common/productTiles/models","common/productTiles/views"],function(e){"use strict";var t=e("lib/lodash"),n=e("common/productTiles/constants"),i=e("lib/lazyLoad"),o=e("lib/disableBodyScroll"),s=e("common/DOMLessView"),a=e("hbtemplate!../templates/BundleDropdownView.html"),r=e("common/productTiles/models"),l=e("common/productTiles/views");return s.extend({className:"js-tile-list tile-list",template:a,events:{"click .js-dropdown-underlay":"hide","click .js-button-title":"toggleIsSelected"},initialize:function(e){this.isSelected=!1,this.tiles=this.createTiles(e)},createTiles:function(e){return t.map(e.productTiles,function(e,i){var o={hmb_source:"navbar",hmb_medium:"product_tile",hmb_campaign:"tile_index_"+(i+1)},s=new r.BundleTile(t.extend({},e,{size:n.TILE_SIZES.ONE_THIRD,product_url:e.product_url+"?"+$.param(o),marketing_blurb:e.short_marketing_blurb}));return new l.NavBarTileView({model:s,size:n.TILE_SIZES.ONE_THIRD})})},listenOnNavbarItems:function(){$(".js-navigation-container-v2 .js-hide-dropdown").on("click.hide-dropdown",this.hide.bind(this))},stopListeningOnNavbarItems:function(){$(".js-navigation-container-v2 .js-hide-dropdown").off("click.hide-dropdown")},toggleIsSelected:function(){this.isSelected?this.hide():this.show()},show:function(){this.isSelected=!0,this.$navbars.addClass("dropdown-active");var e=$(window).scrollTop(),t=this.$topNavbar.offset().top;e!=t&&this.$body.css({transform:"translateY(-"+(t-e)+"px)"}),this.listenOnNavbarItems(),this.lockScrolling()},hide:function(){this.isSelected=!1,this.$navbars.removeClass("dropdown-active"),this.$body.css({transform:"none"}),this.$topNavbar.removeClass("headroom--unpinned").addClass("headroom--pinned"),this.stopListeningOnNavbarItems(),this.unlockScrolling()},lockScrolling:function(){var e=this.$body.width();this.$body.css("overflow","hidden");var n=this.$body.width(),i=n-e;i>0&&(this.$body.css("margin-right",i+"px"),$(".js-maintain-scrollbar-on-dropdown").css("right",i+"px"),this.$navbars.css({"padding-right":i+"px","margin-right":"-"+i+"px"})),t.delay(function(){o.toggle(!0,".js-bundle-dropdown-wrapper")},1)},unlockScrolling:function(){this.$body.css({"margin-right":0}),$(".js-maintain-scrollbar-on-dropdown").css("right",0),this.$navbars.css({"padding-right":0,"margin-right":0}),o.toggle(!1,".js-bundle-dropdown-wrapper")},loadImages:function(){new i({container:this.el,class_loading:"lazy-loading",class_loaded:"lazy-loaded",elements_selector:".js-lazyload"})},serializeData:function(){var e=s.prototype.serializeData.apply(this,arguments);return e.isSelected=this.isSelected,e.tileCount=this.tiles.length,e},onRender:function(){this.$body=$("body"),this.$topNavbar=$(".js-navbar"),this.$navbars=$(".js-navbar, .js-bottom-navbar");var e=$(".js-bundle-dropdown-content");t.each(this.tiles,function(t){e.append(t.render().el)}),this.loadImages()}})}),define("navbar/main",["require","lib/lodash","navbar/views/BundleDropdownView","lib/headroom"],function(e){"use strict";var t=e("lib/lodash"),n=e("navbar/views/BundleDropdownView"),i=e("lib/headroom"),o=function(e){var o=$(".navbar"),a=$(".navigation-container-v2");s()||a.addClass("fake-sticky");var r=$(".js-navigation-tracker"),l=new i(o[0],{$navOffsetTracker:r,offset:r.offset().top,tolerance:{up:0,down:200},offsetBottom:200});l.init();var c=a.find(".js-tabs-navbar-item"),u=a.find(".js-user-navbar-item"),d=a.find(".js-site-search"),h=a.find(".bottom-navbar .navbar-content"),m=function(){var e="breakpoint-navbar-desktop"==window.getComputedStyle(a[0],"::after").getPropertyValue("content").replace(/"/g,"");e?(c.insertBefore(d),u.insertAfter(d)):(h.append(c),h.append(u))}.bind(this);$(window).resize(m),$(window).resize();var p=$(".js-bundle-dropdown"),f=new n(t.extend({},e,{el:p}));f.render()},s=function(){var e=document.createElement("test"),t=e.style;
return t.cssText="position: sticky; position: -webkit-sticky;",t.position.indexOf("sticky")!==-1};return{init:o}});
//# sourceMappingURL=main.js.map